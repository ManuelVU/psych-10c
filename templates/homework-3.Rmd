---
title: "Homework 3"
author: "Write your name here"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
---

```{r load_libraries, echo = FALSE}
# Code 0: Loading the libraries
#
# Use this chunk to load whatever libraries you need. They should already have been
# installed for the first homework, but you need to load them using library()
# in order to use them. IMPORTANT: Remember to delete the comments inside the code
# chunks BEFORE submitting your homework.
```

## Section 1

**Background:** For this section, we will work with a new data set from an 
experiment regarding the effects of naps in the consolidation of information in
memory. A group of researchers is interested in understanding the effects that 
taking a nap can have on memory consolidation. They designed an experiment where
participants are assigned randomly to one of 3 conditions, a control condition 
where participants first study a list of 100 words and, after one hour they are
asked to write down all the words they can remember. In the first experimental
condition, participants are given the same list, after study, each participant 
takes a 15 min nap and again, they are asked to write down all the words they 
can remember from the list after a total of 1 hour has passed since the study
of the list. Finally, the last group is given the same list and after a study 
time they are asked to take a 1 hour nap, once the hour has passed, participants
are asked to write down all the words from the list that they can remember.

We have access to the data of the experiment which includes an *id* assigned to 
each participant, the number of correctly *recalled* words and the experimental
condition that they are assigned to. Due to the nature of the experiment we are 
interested in 4 models, the Null model which assumes that there are no 
differences in the total number of recalled words between conditions. A 
"**15 minutes**" model which assumes that the total number of correctly recalled
words is different only for participants that had the 15 nap. A "**60 minutes**"
mode which assumes that the total number of correctly recalled words is only 
different for participants who had a 1 hour nap. Finally, we are interested 
in the effects model which assumes that each group is different.

```{r load_data, echo = TRUE}
# Code 1: Load the data (Hint: Go back to Lec-10)
#
# In this chunk you should write (a.k.a. copy from the slides) the code needed 
# to load the data for section 1.
```

1. Obtain the predictions of the Null model, add the required values as a 
new variable (column) to the data set (remember to give this new variable a 
name!). What are the total number of correctly recalled words  predicted by 
the Null model for each group?

```{r pred-m1-s1, echo = TRUE}
# Code 2: calculating the predictions made by the Null model
#
# In this code chunk you can write the functions that you need to
# calculate the predictions of the Null model and add it to the data set as a 
# new column. Report the value(s) as text in the space below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

2. Calculate the squared error (SE) of each observation under the Null by adding
a new column to our data set. What is the mean Sum of Squared Errors 
(m-SSE) of the Null model?

```{r sse-m1-s1, echo = TRUE}
# Code 3: Add a Squared Error column and compute the m-SSE for the Null model
# 
# In this code chunk you can write the functions that you need to use in order 
# to calculate the squared error of each observation and the functions you need 
# to calculate the mean sum of squared errors of the Null model.
```

3. What is the value of the Bayesian Information Criterion (BIC) for the Null 
model?

```{r bic-m1-s1, echo = TRUE}
# Code 4: Calculate the BIC for the Null model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated with the Null model. Save it as a new variable 
# and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

4. Obtain the predictions of the Effects model add the required values as a new 
variable (column) to the data set (remember to give this new variable a 
DIFFERENT name!). What are the total number of correctly recalled words 
predicted by the Effects model for each group?

```{r pred-m2-s1, echo = TRUE}
# Code 5: calculating the predictions made by Effects model
#
# In this code chunk you can write the functions that you need to use in order 
# to calculate the predictions of the Effects model and add it to the data set 
# as a new column. Report the value(s) as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

5. Calculate the squared error (SE) for each observation under the Effects model
by adding a new column to the data set (again, watch out the names you give to 
the new column!). What is the mean Sum of Squared Errors (m-SSE) of the Effects 
model?

```{r sse-m2-s1, echo = TRUE}
# Code 6: Add a Squared Error column and compute the m-SSE for the Effects model
#
# In this code chunk you can write the functions that you need to use in order 
# to calculate the squared error of each observation and the functions you need 
# to calculate the mean sum of squared errors of the Effects model.
```

**ANS:** [WRITE YOUR ANSWER HERE]

6. What is the value of the Bayesian Information Criterion (BIC) for the Effects
model?

```{r bic-m2-s1, echo = TRUE}
# Code 7: Calculate the BIC for the Effects model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated with the Effects model. Save it as a new variable  
# and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

7. Obtain the predictions of the 15 minutes model, add the required values as a 
new variable (column) to the data set (remember to give this new variable a 
name!). What are the total number of correctly recalled words  predicted by 
the 15 minutes model for each group?

```{r pred-m3-s1, echo = TRUE}
# Code 8: calculating the predictions made by the 15 minutes model
#
# In this code chunk you can write the functions that you need to
# calculate the predictions of the 15 minutes model and add it to the data set 
# as a new column. Report the value(s) as text in the space below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

8. Calculate the squared error (SE) of each observation under the 15 minutes by adding
a new column to our data set. What is the mean Sum of Squared Errors 
(m-SSE) of the 15 minutes model?

```{r sse-m3-s1, echo = TRUE}
# Code 9: Add a Squared Error column and compute the m-SSE for the 15 minutes model
# 
# In this code chunk you can write the functions that you need to use in order 
# to calculate the squared error of each observation and the functions you need 
# to calculate the mean sum of squared errors of the 15 minutes model.
```

9. What is the value of the Bayesian Information Criterion (BIC) for the 15 minutes 
model?

```{r bic-m3-s1, echo = TRUE}
# Code 10: Calculate the BIC for the 15 minutes model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated with the 15 minutes model. Save it as a new variable 
# and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

10. Obtain the predictions of the 60 minutes model, add the required values as a 
new variable (column) to the data set (remember to give this new variable a 
name!). What are the total number of correctly recalled words  predicted by 
the 60 minutes model for each group?

```{r pred-m4-s1, echo = TRUE}
# Code 11: calculating the predictions made by the 60 minutes  model
#
# In this code chunk you can write the functions that you need to
# calculate the predictions of the 60 minutes model and add it to the data set 
# as a new column. Report the value(s) as text in the space below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

11. Calculate the squared error (SE) of each observation under the 60 minutes by 
adding a new column to our data set. What is the mean Sum of Squared 
Errors (m-SSE) of the 60 minutes  model?

```{r sse-m4-s1, echo = TRUE}
# Code 12: Add a Squared Error column and compute the m-SSE for the 60 minutes model
# 
# In this code chunk you can write the functions that you need to use in order 
# to calculate the squared error of each observation and the functions you need 
# to calculate the mean sum of squared errors of the 60 minutes model.
```

12. What is the value of the Bayesian Information Criterion (BIC) for the 60 
minutes model?

```{r bic-m4-s1, echo = TRUE}
# Code 13: Calculate the BIC for the 60 minutes minutes model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated with the 60 minutes minutes model. Save it as 
# a new variable and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

13. Which of the four models would you select and why?

**ANS:** [WRITE YOUR ANSWER HERE]

14. What does the Model that you selected tell us about our research question?

**ANS:** [WRITE YOUR ANSWER HERE]

15. Interpret the value of $R^2$ associated with the model that you selected.

**ANS:** [WRITE YOUR ANSWER HERE]

## Section 2

**Background:** For this section, we will work with the responses to a memory 
experiment. Researchers are interested in the effects of biological sex and 
word frequency on the total number of words that can be correctly recalled from
a list. For this experiment we have two factors (biological sex and word frequency)
with two levels each (female, male and common rare). For each combination of the 
factor levels we have 20 observations for a total of 80 participants. For this
problem we will consider a total of 4 models, the Null, biological sex main 
effect, word frequency main effect and the additive model. 

```{r load_data2, echo = TRUE}
# Code 14: Load the data (Hint: Go back to Lec-10 and use the link)
#
# In this section you should write the code needed to load the data for
# section 2. IMPORTANT: Remember to delete the comments inside the code 
# chunks BEFORE submitting your homework.
```

16. Obtain the grand mean and the effects of biological sex ($\hat{\alpha}$) and 
word frequency ($\hat{\beta}$).

```{r grand-eff-s2, echo = TRUE}
# Code 15: calculating grand mean and main effects.
#
# In this code chunk you can write the functions that you need to use in order 
# to calculate the grand mean and the effects of each factor.
```

**ANS:** [WRITE YOUR ANSWER HERE]

17. Obtain the predictions of the Null model and add them to the data. After, 
calculate the error of each observation and add it as a new variable. Use those 
values to calculate the SSE and the Mean SE associated with the Null model. 
Report the prediction, SSE and Mean Se of the Null model below.

```{r null-m1-s2, echo = TRUE}
# Code 16: adding predictions, errors and calculating the SSE and Mean SE Null
# model
#
# In this code chunk you can write the functions that you need to use in order 
# to add the predictions and squared errors of the null model to the data.
# Calculate the SSE and the Mean SE from the new variables.
```

**ANS:** [WRITE YOUR ANSWER HERE]

18. What is the value of the Bayesian Information Criterion for the Null model?

```{r bic-null-s2, echo = TRUE}
# Code 17: Calculating the BIC for the Null model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated to the Null model. Save it as a new variable and 
# report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

19. Using the values you obtained in question 16 obtain the predictions of the 
biological sex model, add the predictions to the data, calculate the squared
error of each observation. Then obtain the SSE and the Mean SE associated to 
the biological sex model. Report the prediction, SSE and Mean Se of the Null model below.

```{r bio-m2-s2, echo = TRUE, fig.align = 'center'}
# Code 18: adding predictions, errors and calculating the SSE and Mean SE
# for the biological sex model
#
# In this code chunk you can write the functions that you need to use in order 
# to add the predictions and squared errors of the biological sex model to the
# data. Calculate the SSE and the Mean SE from the new variables.
```

20. What is the value of the Bayesian Information Criterion (bic) for the 
biological sex model?

```{r bic-bio-s2, echo = TRUE}
# Code 19: Calculating the BIC for the biological sex model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated to the biological sex model. Save it as a new 
# variable and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

21. Using the values you obtained in question 16 obtain the predictions of the 
word frequency model, add the predictions to the data, calculate the squared
error of each observation. Then obtain the SSE and the Mean SE associated to 
the word frequency model. Report the prediction, SSE and Mean Se of the Null 
model below.

```{r freq-m2-s2, echo = TRUE, fig.align = 'center'}
# Code 18: adding predictions, errors and calculating the SSE and Mean SE
# for the word frequency model
#
# In this code chunk you can write the functions that you need to use in order 
# to add the predictions and squared errors of the word frequency model to the
# data. Calculate the SSE and the Mean SE from the new variables.
```

22. What is the value of the Bayesian Information Criterion (bic) for the 
word frequency model?

```{r bic-bio-s2, echo = TRUE}
# Code 19: Calculating the BIC for the word frequency model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated to the word frequency model. Save it as a new  
# variable and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

23. Using the values you obtained in question 16 obtain the predictions of the 
additive model, add the predictions to the data, calculate the squared
error of each observation. Then obtain the SSE and the Mean SE associated to 
the word frequency model. Report the prediction, SSE and Mean Se of the Null 
model below.

```{r freq-m2-s2, echo = TRUE, fig.align = 'center'}
# Code 18: adding predictions, errors and calculating the SSE and Mean SE
# for the additive model
#
# In this code chunk you can write the functions that you need to use in order 
# to add the predictions and squared errors of the additive model to the
# data. Calculate the SSE and the Mean SE from the new variables.
```

24. What is the value of the Bayesian Information Criterion (bic) for the 
additive model?

```{r bic-bio-s2, echo = TRUE}
# Code 19: Calculating the BIC for the additive model
#
# In this code chunk you can write the functions that you need in order to 
# calculate the BIC associated to the additive model. Save it as a new  
# variable and report the value as text below.
```

**ANS:** [WRITE YOUR ANSWER HERE]

25. Which of the four models would you select and why?

**ANS:** [WRITE YOUR ANSWER HERE]


26. What does the Model that you selected tell us about our research question?

**ANS:** [WRITE YOUR ANSWER HERE]
