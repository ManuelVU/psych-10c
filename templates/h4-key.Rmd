---
title: "Rubric-homework 4"
author: "Write your name here"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
---

```{r load-library, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
```

```{r load_data, echo = FALSE, message=FALSE, warning=FALSE}
link <- "https://raw.githubusercontent.com/ManuelVU/psych-10c-data/main/homework4.csv"
memory <- read_csv(file = link)
```

1. **(0.5 points)**

```{r cell-means, echo = TRUE, message=FALSE, warning=FALSE}
full <- memory %>% 
  group_by(task, word_frequency) %>% 
  summarise("pred" = mean(recalled))
```

**ANS:** The average number of correctly recalled words by combination of the 
task and word frequency factors was:

| Task        | Word Frequency | Mean                      | Points        | 
|-------------|----------------|:-------------------------:|---------------|
| Free recall | High           | `r round(full$pred[1],2)` | **0.125 pts** |
| Free recall | Low            | `r round(full$pred[2],2)` | **0.125 pts** |
| Recognition | High           | `r round(full$pred[3],2)` | **0.125 pts** |
| Recognition | Low            | `r round(full$pred[4],2)` | **0.125 pts** |

2. **(0.5 points)**

```{r task-mean, echo = TRUE}
task <- memory %>% 
  group_by(task) %>% 
  summarise("mean" = mean(recalled))
```

**ANS:** The average number fo correctly recalled words by task was:

| Task        | Mean                      | Points       | 
|-------------|:-------------------------:|--------------|
| Free recall | `r round(task$mean[1],2)` | **0.25 pts** |
| Recognition | `r round(task$mean[2],2)` | **0.25 pts** |

3. **(0.5 points)**

```{r wordfreq-mean, echo = TRUE}
wf <- memory %>% 
  group_by(word_frequency) %>% 
  summarise("mean" = mean(recalled))
```

**ANS:** The average number fo correctly recalled words by word frequency was:

| Word Frequency | Mean                      | Points       | 
|----------------|:-------------------------:|--------------|
| High           | `r round(wf$mean[1],2)`   | **0.25 pts** |
| Low            | `r round(wf$mean[2],2)`   | **0.25 pts** |

4. **(0.5 points)**

```{r grand-mean, echo = TRUE}
grand_mean <- memory %>% 
  summarise("mean" = mean(recalled)) %>% 
  pull(mean)
```

**ANS:** The average number of correctly recalled words was **`r round(grand_mean,2)`**

5. **(0.5 points)**

```{r me-task, echo = TRUE}
alpha <- task$mean - grand_mean
```

**ANS:** The main effect of the free recall task was **`r round(alpha[1],2)`**,
the main effect of the recognition task was **`r round(alpha[2],2)`**

6. **(0.5 points)**

```{r me-wordfreq, echo = TRUE}
beta <- wf$mean - grand_mean
```

**ANS:** The main effect for high frequency words was **`r round(beta[1],2)`**,
the main effect of low frequency words was **`r round(beta[2],2)`**

7. **(0.5 points)**

```{r pred-null, echo = TRUE}
memory <- memory %>% 
  mutate("prediction_null" = grand_mean,
         "error_null" = (recalled - prediction_null)^2)
```

8. **(0.5 points)**

```{r pred-me-task, echo = TRUE}
memory <- memory %>% 
  mutate("prediction_task" = case_when(task == "free_recall" ~ grand_mean + alpha[1],
                                       task == "recognition" ~ grand_mean + alpha[2]),
         "error_task" = (recalled - prediction_task)^2)
```

**ANS:** The predictions of the task main effects model by combination of the
factor levels are: 

| Task        | Word Frequency | Mean                      | Points        | 
|-------------|----------------|:-------------------------:|---------------|
| Free recall | High           | `r round(grand_mean+alpha[1],2)` | **0.125 pts** |
| Free recall | Low            | `r round(grand_mean+alpha[1],2)` | **0.125 pts** |
| Recognition | High           | `r round(grand_mean+alpha[2],2)` | **0.125 pts** |
| Recognition | Low            | `r round(grand_mean+alpha[2],2)` | **0.125 pts** |

9. **(0.5 points)**

```{r pred-me-wordfreq, echo = TRUE}
memory <- memory %>% 
  mutate("prediction_wf" = case_when(word_frequency == "high" ~ grand_mean + beta[1],
                                     word_frequency == "low" ~ grand_mean + beta[2]),
         "error_wf" = (recalled - prediction_wf)^2)
```

**ANS:** The predictions of the word frequency main effects model by combination 
of the factor levels are: 

| Task        | Word Frequency | Mean                      | Points        | 
|-------------|----------------|:-------------------------:|---------------|
| Free recall | High           | `r round(grand_mean+beta[1],2)` | **0.125 pts** |
| Free recall | Low            | `r round(grand_mean+beta[2],2)` | **0.125 pts** |
| Recognition | High           | `r round(grand_mean+beta[1],2)` | **0.125 pts** |
| Recognition | Low            | `r round(grand_mean+beta[2],2)` | **0.125 pts** |

10. **(0.5 points)**

```{r pred-additive, echo = TRUE}
memory <- memory %>% 
  mutate("prediction_add" = case_when(
    task == "free_recall" & word_frequency == "high" ~ grand_mean + alpha[1] + beta[1],
    task == "free_recall" & word_frequency == "low" ~ grand_mean + alpha[1] + beta[2],
    task == "recognition" & word_frequency == "high" ~ grand_mean + alpha[2] + beta[1],
    task == "recognition" & word_frequency == "low" ~ grand_mean + alpha[2] + beta[2]
  ),
  "error_add" = (recalled - prediction_add)^2)
```

**ANS:** The predictions of the additive model by combination  of the factor 
levels are: 

| Task        | Word Frequency | Mean                      | Points        | 
|-------------|----------------|:-------------------------:|---------------|
| Free recall | High           | `r round(grand_mean+alpha[1]+beta[1],2)` | **0.125 pts** |
| Free recall | Low            | `r round(grand_mean+alpha[1]+beta[2],2)` | **0.125 pts** |
| Recognition | High           | `r round(grand_mean+alpha[2]+beta[1],2)` | **0.125 pts** |
| Recognition | Low            | `r round(grand_mean+alpha[2]+beta[2],2)` | **0.125 pts** |

11. **(0.5 points)**

```{r pred-full, echo = TRUE}
memory <- memory %>% 
  mutate("prediction_full" = case_when(
    task == "free_recall" & word_frequency == "high" ~ full$pred[1],
    task == "free_recall" & word_frequency == "low" ~ full$pred[2],
    task == "recognition" & word_frequency == "high" ~ full$pred[3],
    task == "recognition" & word_frequency == "low" ~ full$pred[4]),
  "error_full" = (recalled - prediction_full)^2)
```

**ANS:** The predictions of the full model are:

| Task        | Word Frequency | Mean                      | Points        | 
|-------------|----------------|:-------------------------:|---------------|
| Free recall | High           | `r round(full$pred[1],2)` | **0.125 pts** |
| Free recall | Low            | `r round(full$pred[2],2)` | **0.125 pts** |
| Recognition | High           | `r round(full$pred[3],2)` | **0.125 pts** |
| Recognition | Low            | `r round(full$pred[4],2)` | **0.125 pts** |

12. **(0.5 points)**

```{r sse-5models, echo = TRUE}
sse_null <- sum(memory$error_null)
sse_task <- sum(memory$error_task)
sse_wf <- sum(memory$error_wf)
sse_add <- sum(memory$error_add)
sse_full <- sum(memory$error_full)
```

**ANS:** The SSE by model are:

| Model             | SSE                   | Points        |
|-------------------|:---------------------:|:-------------:|
| Null              | `r round(sse_null,2)` | **0.1 pts** |
| Me Task           | `r round(sse_task,2)` | **0.1 pts** |
| Me Word Frequency | `r round(sse_wf,2)`   | **0.1 pts** |
| Additive          | `r round(sse_add,2)`  | **0.1 pts** |
| Full              | `r round(sse_full,2)` | **0.1 pts** |

13. **(0.5 points)**

```{r mse-5models, echo = TRUE}
n_total <- nrow(memory)
mse_null <- 1/n_total * sum(memory$error_null)
mse_task <- 1/n_total * sum(memory$error_task)
mse_wf <- 1/n_total * sum(memory$error_wf)
mse_add <- 1/n_total * sum(memory$error_add)
mse_full <- 1/n_total * sum(memory$error_full)
```

**ANS:** The SSE's by model are:

| Model             | MSE                   | Points        |
|-------------------|:---------------------:|:-------------:|
| Null              | `r round(mse_null,2)` | **0.1 pts** |
| Me Task           | `r round(mse_task,2)` | **0.1 pts** |
| Me Word Frequency | `r round(mse_wf,2)`   | **0.1 pts** |
| Additive          | `r round(mse_add,2)`  | **0.1 pts** |
| Full              | `r round(mse_full,2)` | **0.1 pts** |

14. **(1 point)**

```{r bic-5models, echo = TRUE}
bic_null <- n_total * log(mse_null) + 1 * log(n_total)
bic_task <- n_total * log(mse_task) + 2 * log(n_total)
bic_wf <- n_total * log(mse_wf) + 2 * log(n_total)
bic_add <- n_total * log(mse_add) + 3 * log(n_total)
bic_full <- n_total * log(mse_full) + 4 * log(n_total)
```

**ANS:** The BIC of each model is:

| Model             | BIC                   | Points        |
|-------------------|:---------------------:|:-------------:|
| Null              | `r round(bic_null,2)` | **0.2 pts** |
| Me Task           | `r round(bic_task,2)` | **0.2 pts** |
| Me Word Frequency | `r round(bic_wf,2)`   | **0.2 pts** |
| Additive          | `r round(bic_add,2)`  | **0.2 pts** |
| Full              | `r round(bic_full,2)` | **0.2 pts** |


15. **(1 point)**

**ANS:** The model with the lowest BIC was the Full model, which is the one 
that they should choose. However, try to grade on consistency, if there is an 
error on the code that made them get different BIC values, consider 
following the rule (choose the model with the lowest BIC) as a correct answer

16. Calculate the value of $R^2$ of the model that you choose in (14). What is 
the value of $R^2$ of the model you selected and how can you interpret it?

```{r r2-5models, echo = TRUE}
r2_task <- (sse_null - sse_task)/sse_null
r2_wf <- (sse_null - sse_wf)/sse_null
r2_add <- (sse_null - sse_add)/sse_null
r2_full <- (sse_null - sse_full)/sse_null
```

**ANS:** The correct answer should be: The proportion of variance accounted 
for by the **full** model was `r round(100*r2_full,2)`%.

However, if the student made a mistake in the code and selected a different 
model that is not the full, here are the rest of the possible values for $R^2$

| Model             | $R^2$                   |
|-------------------|:---------------------:|
| Me Task           | `r round(r2_task,2)` |
| Me Word Frequency | `r round(r2_wf,2)`   |
| Additive          | `r round(r2_add,2)`  |
| Full              | `r round(r2_full,2)` |

As long as the answer is consistent give them the points

17. **(1 point)**

**ANS:** Participants are better at free recall when the list is made up from 
high frequency words in comparison to low frequency words, in contrast, 
they are better at recognizing words that have a low frequency in comparison 
to high frequency words.

18. **(0.5 points)** 

**ANS:** There is an interaction between the type of task (free recall vs 
recognition) and the frequency of the words that participants study. The effect
of moving from low to high frequency words is positive in free recall tasks 
and negative in recognition tasks.

The answer doesn't have to be this specific but the idea is that the effect of 
word frequency is different by task.



